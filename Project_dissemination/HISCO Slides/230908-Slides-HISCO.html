<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>230908-Slides-HISCO.knit</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.21/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.28/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  </head>
  <body>
    <textarea id="source">

class: center, inverse

&lt;style type="text/css"&gt;
.pull-left {
  float: left;
  width: 44%;
}
.pull-right {
  float: right;
  width: 44%;
}
.pull-right ~ p {
  clear: both;
}
&lt;/style&gt;



# Breaking the HISCO Barrier: AI and Occupational Data Standardization
## Christian MÃ¸ller-Dahl
## Christian Vedel
### University of Southern Denmark, HEDG

#### Twitter: @ChristianVedel,
#### Email: christian-vs@sam.sdu.dk
#### Updated 2023-09-09 

---

# Introduction
.pull-left[
### Motivation
- Manual labelling of data is tedious, expensive and error-prone  
- We collectively poor thousands of hours into similar work
- 4 mil. `\(\rightarrow\)` 96k `\(\rightarrow\)` 605 days of work 


### This presentation
- **Automatic tool to make HISCO labels** 
- Early work in progress 
- 98 percent precision
- How it is done 
]

.pull-right[
![Iron_and_coal](Figures/Iron_and_coal.jpg)
*Willam Bell Scott (1861) "Iron and Coal" (Wikimedia)*

]

---
# HISCO codes
- Derived from ISCO (International Standard Classification of Occupations) 
- Invented for the sake of international comparability  
- Introduced by Leuwen, Maas, Miles (2002) based on ISCO68  
- Hiearchical structure well suited for analysis
- Common application: Convert to ranking (HISCAM, HISCLASS, etc. )
- Usually labelled with 'smart' manual methods 

![HISCO](Figures/HISCO structure.png)

---
# Data example
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-79a1fe5cc018c41be04a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-79a1fe5cc018c41be04a">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351"],["farmer","labourer","sawyer","warehouseman","vicar of harpford","bank clerk","bricklayer","sergeant r.e.","carder","iron moulder","clerk in an office","engraver","miner","baker","plumber hm dockyard","miller","provision dealer","tailor","cabinet maker","mechanical driller","carrier","carpenter","turner","mariner","commercial traveller","carman","engineer","workman","carter","mechanic","soldier","boot and shoe maker","drover","cutler","brick setter","collier","school master","horsenailer","potter","overlooker","engineer","wire drawer","butcher","weaver","match maker","major general, rha, retired","slater","servant","wesleyan minister","bookkeeper","warder","railway shunter","joiner","farm labourer","blacksmith","groom","fisherman","carter (deceased)","shipbroker","publican","ribbon weaver","jeweller","retired","engine driver","licensed victualler","cotton manufacturer","tin plate worker","mason","storeman","dock laborer","painter","caster","plaisterer","maltster","iron worker","baker (deceased)","cottager","fitter","shoemaker","painter and glazier","tanner","plate layer","insurance agent","works manager","inn keeper","lighterman","blacksmith deceased","chain maker","h. m. f.","shipwright","agric labr","labourer (deceased)","book keeper","tank plater","spinner","foreman","crane driver","boatman","sailmaker","builder","tinner","lurryman","water man","architect","grocer","roller","pharmaceutical chemist","lockmaker","potter","wheelwright","manager","shoe finisher","iron merchant","pitman","brick maker","greengrocer","tinker","waterman","shoe maker","coachman (deceased)","clerk","bill poster","puddler","yeoman","linen manufacturer","motor body trimmer","grinder","crofter","tin smelter","police constable","confectioner","delver","farmer (deceased)","laborer","forge man","porter and labour master","higher executive officer, department of industry","linesman","gardener","railway driver","surgeon","book binder","h.m's navy","brickmaker","lead smelter","traveller","china dealer","coppersmith","accountant","pilot","engine driver lwer","driller h.m. dockyard","army pensioner","file maker","cabinetmaker","foundryman","clerk (deceased)","agricultual foreman","railway servant","ship carpenter","millwright","draper","clothier","stock taker","keeper","smith","farrier","cotton operative","steelworker","coachman","trainer retired","cotton operative","innkeeper","scientist","gun lockfiler","poulterer","naval pensioner","hair dresser","bailiff","gane intake manager","master mariner","electrician","clerk in warehouse","cotton spinner","school teacher","merchant","core maker","engine fitter","schoolmaster","dealer","stonemason","decorator","shoeing smith","lorry driver","boiler maker","nail master","miller","farm bailiff","little farmer","twine spinner","leather cutter","whitesmith","shepherd","iron-monger","farm worker","harness maker","silk mercer","carpenter, joiner","garage proprieter","hawker","selfactor minder","trimmer","railway contractor","plumber","mine agent","plasterer","chassis erector","groom and gardener","carpet yarn spinner","guard","miner (deceased)","gentleman's servant","mill sawyer","furnaceman","woollen dresser","railway inspector","retired farmer","polisher","veterinary surgeon","coal agent","brick layer","house steward","brck layera","rivet maker","nailor","welder","builder's labourer","bootmaker","tailor (deceased)","boot finisher","boot maker","gas fitter","mine agent","farmer and publican","labourer - deceased","rm","cal:printer","optician","inland revenue","locksmith","auctioneer's assistant","licenced victualler","retired miner","pedlar","piecer","transport driver","civil servant","dresser","coach man","process worker","gun maker","dead","yeoman and relieving officer","saddler","brick burner","bottle maker","clerk in holy orders","stone cutter","corn miller","shopkeeper","porter","post master (deceased)","signalman on railway","glass cutter","nailer","baptist minister","draughtsman","private machine gun corps","boot closer","agricultural worker","pit carpenter","pressman","boiler smith","moulder","sub-contractor on the railway","cashier","upholsterer","clerk in holy orders, chaplain to the hon. east india company","maker up","twiner","brass founder","company director","electro plate polisher","contractor","farmer?","head gardener","watchmaker","decorator and contractor","timber merchant","fruit dealer","brassfounder","ship's corporal rn","game keeper","brass finisher","gamekeeper","ostler","potseller","banker's clerk","driver","solicitor","paper maker","waste dealer","publican (dec)","cordwainer","woodcutter","chair maker","plant supervisor","stevedore","butcher","railway guard","corn porter","tradesman","quarryman","corn miller","coach driver","furnace man","hatter, deceased","publican (deceased)","power loom weaver","steeple jack","plumber and glazier","loomer in cotton mill","sergeant r.g.a.","master plumber","footman","tailors assistant","sanitary inspector","fireman","underground manager","coal merchant","house decorator","bobber and polisher","hydraulic packer","clicker","dyer","farm servant","auctioneer","manager, iron works","gunner, royal artillery","glover","pharmacist"],["61110","99910","73210","97145","14120","33940","95120","58330","75135","72500","30000","92400","71105","77610","87105","99910","41025","79100","81120","71300","98620","95410","83320","98135","43220","98620","2000","99910","98620","84900","58340","80110","62490","83915","95120","71105","13020","83990","89210","22000","84100","72725","72500","75400","99999","58320","95320","62120","14120","33110","31000","98320","95410","99910","83110","62490","64100","98620","44140","51050","75400","88010","-1","96910","51050","21110","87340","95145","97145","97120","93120","72500","95510","77810","72500","77610","61115","84100","80110","93120","76145","99910","44120","21000","51020","98190","83110","83110","58300","95440","99910","99910","33110","72890","75220","22610","96910","98190","79920","95910","87340","98620","98190","2120","41030","72100","41030","83930","17000","81925","21000","80110","41025","71105","89242","41030","87340","98190","80110","98620","30000","59990","72190","61115","21110","81920","83530","61115","74490","58220","77660","99910","61110","99910","83110","99910","31000","85700","62700","98320","6100","92625","98130","89242","21220","43220","41025","87330","33110","58320","98320","71300","58340","83110","81120","72000","14120","22610","39960","95410","95440","41030","41030","39140","64990","83110","83110","75000","72100","98620","62490","99930","51020","1390","83590","41030","98130","57025","22520","22000","4215","2305","30000","75220","13020","41025","72500","84100","13020","41025","95145","93120","83110","98555","87350","83990","77120","22520","61115","75220","80310","87340","62430","41030","99910","80320","41030","95410","41040","45220","75220","79990","21240","87105","22620","95510","87400","62740","75220","98420","71105","62120","73210","89320","99930","22000","61110","83590","6510","43200","95120","55100","95120","87462","83990","87210","99910","80110","79100","80110","80110","87120","43200","61110","99910","58300","92950","7530","31000","83110","30000","51050","71105","45220","99930","96910","30000","75600","98620","99930","83920","-1","61115","80320","89242","99999","14120","95145","77120","41030","97125","22220","98430","89156","83990","14120","3110","58340","80110","99910","95410","92950","83110","72500","21240","33135","79620","14120","99930","75000","72500","21000","83590","21240","61110","22610","84220","93120","41025","41025","72500","58330","64990","83590","64990","62460","45125","33940","98590","12410","73400","41025","51050","80110","63220","81120","22000","97120","77310","98420","97125","95920","71110","99910","98590","89320","79310","51050","75400","55240","87105","75000","58330","87105","54090","79100","22000","98330","22000","41025","93120","83590","97152","80110","75622","99910","44320","21000","58340","79475","41030"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>occ1<\/th>\n      <th>hisco_1<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
.pull-left[
## The naive solution
- List all unique occupational descriptions and label them e.g. "farm servant: 62120"
- Label via lookup table  

## The challenge
- 17865 different occupational descriptions fit with "farm servant" in DK censuses ("in service", "servant girl", "servant boy", "servant woman", "servant karl")
- HISCO has ~2000 occupational classes, each with similar complexity in writing 
- Spelling mistakes, **negations**, and different spelling conventions

]

--
.pull-right[
## The solution
![arhc_small](Figures/Architecture_small.png)
- Use machine learning! 
- Multi-label multiple classification 
- Trivial machine learning problem 
- Apply tricks from the machine learning literature to improve performance on unseen examples
]

---

.pull-left[
## The tricks

- Unseen test and validation data 
- LSTM reccurent: Reads with memory "lives of fishing and farm work" (Hochreiter, Schmidhuber, 1997)
- Overparameterized neural network: More parameters than data (Allen-Zhu, Li, Liang, 2018) 
- Regularization via dropout: Some neurons are randomly disabled in training (Srivastava et al 2014) 
- Embedding: Represent language in high-dimensional space  (Mandelbaum, 2016)
- Data augmentation (Moris et al, 2020): 
  + "farmer": {"farmtr", "fermer", "yellow farmer"}
]


.pull-right[
**Overfitting**
![Overfitting](https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/Overfitting.svg/300px-Overfitting.svg.png)
(Wikimedia)

### Metrics
- Accuracy
- Precision
- Recall 
- F1 
- Micro- and macro-level 
- In training: Binary cross-entropy (differentiable)
]

---
# Data sources 
.pull-left[
### Training data

- Danish Census data (1787-1901) 
  + Has manual HISCO labels for 1787, 1801, 1845, 1880 
  + 3.7 mio labels 
- UK marriage certificates (1837-1939)
  + Labelled Clark, Cummins, Curtis (2022)
  + 4.2 mio labelled observations 
  
- *Adequate performance down to 10.000 labels*
]

.pull-right[
### Other data
- Swedish census data
- Norwegian census data
- Dutch family history data 
- Labelled biographies
- IPUMS
- Barcelona Historical Marriage Database
- ~70GB

### Call for data!
- If you have something with HISCO labels on it, please send it to christian-vs@sam.sdu.dk. I owe you HISCO codes 

]


---
# The architecture
![Arch2](Figures/Architecture.png)

### Training 
- Model starts at random state
- Continuously tweaked towards more correct predictions

### Ongoing work
- Replacing the brains by a transformer model (BERT) *akin to a chatGPT-frankenstein*

---
# Training
![Training](Figures/Training process.png)

### Stopping condition 
- When validation loss has not improved for 10 epochs training stops

---
# The product

```r
# Example prompts
string_to_hisco("A farmer")
string_to_hisco("Tailor of beautiful dresses")
string_to_hisco("The train's fireman")
```

--


```
##                        string hisco                    description
## 1                    A farmer 61110                 General Farmer
## 2 Tailor of beautiful dresses 79100 Tailor, Specialisation Unknown
## 3         The train's fireman 98330    Railway SteamEngine Fireman
```


---
# The performance (1/x)

*DK data based on 300.000 validation observations*

### Macro level performance


|level |    recall| precision|        f1|
|:-----|---------:|---------:|---------:|
|macro | 0.9707673| 0.9805047| 0.9755535|


--

### Micro level


|level |    recall| precision|        f1|
|:-----|---------:|---------:|---------:|
|micro | 0.8228573| 0.9100653| 0.8989688|


---
# The performance (2/6)
![Recalls](Figures/Recall.png)

---
# The performance (2/6)
![Recalls](Figures/Precision.png)
---
# The performance (2/6)
![Recalls](Figures/F1.png)

---
# The performance (3/6): Confusion matrix
![Conf_mat1](Figures/conf_mat_lvl5.png)
---
# The performance (3/6): Confusion matrix
![Conf_mat1](Figures/conf_mat_lvl4.png)
---
# The performance (3/6): Confusion matrix
![Conf_mat1](Figures/conf_mat_lvl3.png)

---
# The performance (3/6): Confusion matrix
![Conf_mat1](Figures/conf_mat_lvl2.png)
---
# The performance (3/6): Confusion matrix
![Conf_mat1](Figures/conf_mat_lvl1.png)

---
# The performance (4/6)

### Results for fewer samples

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-70f5d7c8e7430c4cefd9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-70f5d7c8e7430c4cefd9">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13"],["10^3","10^3","10^3","10^4","10^4","10^4","10^5","10^5","10^5","All","All","10^5","All"],[0,0.2,0.5,0,0.2,0.5,0,0.2,0.5,0,0.2,0.2,0.2],["DK","DK","DK","DK","DK","DK","DK","DK","DK","DK","DK","UK","UK"],[0.698,0.877,0.842,0.831,0.9360000000000001,0.947,0.959,0.966,0.963,0.967,0.972,0.96,0.973],[0.6889999999999999,0.887,0.866,0.907,0.949,0.959,0.971,0.972,0.974,0.973,0.975,0.961,0.972],[0.707,0.867,0.82,0.768,0.924,0.9360000000000001,0.948,0.96,0.953,0.962,0.971,0.96,0.974]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sample_size<\/th>\n      <th>aug. prob.<\/th>\n      <th>source<\/th>\n      <th>f1<\/th>\n      <th>precision<\/th>\n      <th>recall<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"className":"dt-right","targets":[2,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>


---
# The performance (5/6)

### Results for fewer samples

![Fewer](Figures/Performance_in_different_settings.png)

---
# Performance (6/6) 
**Some preliminary results** 
- Even better performance for UK data 
- 90% accuracy on Copenhagen burial records (100 random samples)
- ~90% accuracy in Norwegian census data
- 80% accuracy on Faroe Island data 


**Conversion to status scores as validation**
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b8148e4eec6bae4df1e8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b8148e4eec6bae4df1e8">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4"],["hisclass","hisclass_5","socpo","hiscam_u1"],[0.00161509,0.00203475,-0.0361373,-0.000976822],[0.480137,0.202318,2.71758,1.55728],[0.480139,0.202328,2.71782,1.55728],[13,5,42,99]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Statistic<\/th>\n      <th>Bias<\/th>\n      <th>Standard_error<\/th>\n      <th>RMSE<\/th>\n      <th>Scale<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---


#### An applcation

![Event](Figures/Map.png)

---
# Empirical strategy

`$$log(y_{it}) = Affected_i \times Year_t \beta_t + FE + \varepsilon_{it}$$`


---
### Breach `\(\rightarrow\)` Parishes with fishermen
![Fish1](Figures/fish_extensive.png)

---
# Conclusion

.pull-left[
### Steps ahead
- Transferlearning 
- A generalized understand of occupational descriptions
- Application oriented validation

**Please let me know**
- How do we make this a tool? 
- &lt;p style="color:red;"&gt;If you have data to HISCO codes, please send it to me (christian-vs@sam.sdu.dk)&lt;/p&gt;
- &lt;p style="color:red;"&gt;In return I owe you HISCO codes for your project!&lt;/p&gt;

]

.pull-right[
![Embedding](Figures/Embeddings_illustration.png)
*From Dahl et al (2021)*
]





    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(Logos.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 83px;
  height: 96px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // insert more to hide here
    ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
